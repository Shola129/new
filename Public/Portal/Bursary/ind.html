<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bursar Dashboard - Financial Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== RESET & BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        /* ===== VARIABLES ===== */
        :root {
            --primary: #2c5aa0;
            --primary-dark: #1e3a6f;
            --secondary: #4a6572;
            --success: #2e7d32;
            --danger: #c62828;
            --warning: #f57c00;
            --light: #f8f9fa;
            --dark: #343a40;
            --gray: #6c757d;
            --gray-light: #e9ecef;
            --border: #dee2e6;
        }
        
        /* ===== LAYOUT ===== */
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* ===== SIDEBAR ===== */
        .sidebar {
            width: 260px;
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .logo {
            padding: 0 20px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
        }
        
        .logo h2 {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .logo h2 i {
            font-size: 1.8rem;
        }
        
        .nav-menu {
            padding: 0 15px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 5px;
            transition: all 0.3s;
        }
        
        .nav-item:hover {
            background-color: rgba(255,255,255,0.1);
            color: white;
        }
        
        .nav-item.active {
            background-color: rgba(255,255,255,0.15);
            color: white;
            font-weight: 600;
        }
        
        .nav-item i {
            width: 24px;
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        /* ===== MAIN CONTENT ===== */
        .main-content {
            flex: 1;
            margin-left: 260px;
            transition: margin-left 0.3s ease;
        }
        
        /* ===== TOP HEADER ===== */
        .top-header {
            background-color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-title h3 {
            color: var(--primary);
            font-size: 1.5rem;
            margin-bottom: 5px;
            margin-left: 20px;
            text-align: center;
        }
        
        .header-title p {
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 15px;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }
        
        .logout-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background-color 0.3s;
        }
        
        .logout-btn:hover {
            background-color: var(--primary-dark);
        }
        
        /* ===== CONTENT SECTIONS ===== */
        .content-wrapper {
            padding: 30px;
        }
        
        .section {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            margin-bottom: 30px;
            overflow: hidden;
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .section-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-header h2 {
            color: var(--primary);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-badge {
            background-color: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .section-content {
            padding: 30px;
        }
        
        /* ===== DASHBOARD STATS ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: var(--light);
            border-radius: 10px;
            padding: 25px;
            border-left: 4px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .stat-card.income {
            border-left-color: var(--success);
        }
        
        .stat-card.outcome {
            border-left-color: var(--danger);
        }
        
        .stat-card.balance {
            border-left-color: var(--warning);
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
        }
        
        .stat-icon.income {
            background-color: var(--success);
        }
        
        .stat-icon.outcome {
            background-color: var(--danger);
        }
        
        .stat-icon.balance {
            background-color: var(--warning);
        }
        
        .stat-info h3 {
            font-size: 2rem;
            color: var(--dark);
            margin-bottom: 5px;
        }
        
        .stat-info p {
            color: var(--gray);
            font-size: 0.95rem;
        }
        
        /* ===== PAYMENT FORMS ===== */
        .form-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        /* ===== BUTTONS ===== */
        .btn {
            padding: 12px 25px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-secondary {
            background-color: var(--gray-light);
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background-color: var(--border);
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #1b5e20;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #b71c1c;
        }
        
        /* ===== TRANSACTIONS TABLE ===== */
        .table-container {
            overflow-x: auto;
        }
        
        .transactions-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
            overflow-x: auto;
        }
        
        .transactions-table th {
            background-color: var(--light);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--dark);
            border-bottom: 2px solid var(--border);
        }
        
        .transactions-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }
        
        .transactions-table tr:hover {
            background-color: var(--gray-light);
        }
        
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-completed {
            background-color: rgba(46, 125, 50, 0.1);
            color: var(--success);
        }
        
        .status-pending {
            background-color: rgba(245, 124, 0, 0.1);
            color: var(--warning);
        }
        
        .type-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .type-income {
            background-color: rgba(46, 125, 50, 0.1);
            color: var(--success);
        }
        
        .type-outcome {
            background-color: rgba(198, 40, 40, 0.1);
            color: var(--danger);
        }
        
        /* ===== RECEIPT MODAL ===== */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 10px;
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .confirm-modal-content {
            background-color: white;
            border-radius: 10px;
            max-width: 700px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            color: var(--primary);
            font-size: 1.5rem;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--gray);
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-btn:hover {
            background-color: var(--gray-light);
        }
        
        .modal-body {
            padding: 30px;
        }
        
        /* ===== CONFIRMATION MODAL STYLES ===== */
        .confirm-details {
            margin: 20px 0;
        }
        
        .confirm-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--gray-light);
        }
        
        .confirm-item:last-child {
            border-bottom: none;
        }
        
        .confirm-label {
            font-weight: 600;
            color: var(--dark);
        }
        
        .confirm-value {
            color: var(--primary);
            font-weight: 500;
            text-align: right;
            max-width: 300px;
            word-break: break-word;
        }
        
        .confirm-highlight {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            text-align: center;
            padding: 15px;
            background-color: rgba(44, 90, 160, 0.1);
            border-radius: 8px;
            margin: 20px 0;
        }
        
        /* ===== RECEIPT STYLES ===== */
        .receipt {
            background-color: white;
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 30px;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .receipt-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }
        
        .receipt-header h2 {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 10px;
        }
        
        .receipt-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .receipt-item {
            margin-bottom: 15px;
        }
        
        .receipt-item label {
            font-weight: 600;
            color: var(--dark);
            display: block;
            margin-bottom: 5px;
        }
        
        .receipt-item .value {
            color: var(--gray);
        }
        
        .receipt-amount {
            text-align: center;
            padding: 25px;
            background-color: var(--light);
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .receipt-amount .amount {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .receipt-footer {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            color: var(--gray);
        }
        
        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        /* ===== MOBILE MENU TOGGLE ===== */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1001;
            background-color: var(--primary);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 8px;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-menu-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .top-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
                padding: 15px 20px;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .content-wrapper {
                padding: 20px;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
                padding: 15px 20px;
            }
            
            .section-content {
                padding: 20px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-actions {
                flex-direction: column;
            }
            
            .receipt-details {
                grid-template-columns: 1fr;
            }
            
            .receipt-amount .amount {
                font-size: 2.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .content-wrapper {
                padding: 15px;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .receipt {
                padding: 20px;
            }
        }
        
        /* ===== PRINT STYLES ===== */
        @media print {
            .sidebar,
            .top-header,
            .modal-header,
            .modal-actions,
            .mobile-menu-toggle {
                display: none !important;
            }
            
            .modal {
                position: static;
                background-color: white;
                padding: 0;
            }
            
            .modal-content {
                max-width: 100%;
                max-height: none;
                box-shadow: none;
                border-radius: 0;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            .receipt {
                border: none;
                box-shadow: none;
            }
        }
         .bursar-moblie{
                            display: flex;
                            justify-content: space-between;
                            margin-bottom: 20px;
                        }
                        .search-term-session{
                            display: block;
                            float: left;

                        }
                        .search-term-session button{
                            margin-top: 10px;
                            padding: 5px;
                            background-color: var(--color-accent);
                            color: white;
                            border: none;
                            border-radius: 3px;
                            cursor: pointer;
                        }
                        .search-date{ 
                            display: block;
                            float: left;
                            margin-right: 20px;
                        }
                        .search-date button{
                            margin-top: 10px;
                            padding: 5px;
                            background-color: var(--color-accent);
                            color: white;
                            border: none;
                            border-radius: 3px;
                            cursor: pointer;
                        }
                        .search-date input{
                            margin-right: 10px;
                            width: 150px;
                        }
                        .search-term-session select{
                            margin-right: 10px;
                            width: 120px;
                            
                        }
                        .btn2{width: 120px; height: 25px; background-color: #343a40; color: #2e7d32;}
                        .but{width: 150px; margin-top: 10px; height: 30px;}
                        .but3{width: 100px; margin-top: 10px; height: 30px;}

                        @media (max-width: 900px) {
                            #transactions-section{
                                overflow-x: scroll;
                                overflow-y: hidden;

                            }
                        }
                        /* ===== RESPONSIVE DESIGN ===== */
@media (max-width: 992px) {
    .sidebar {
        transform: translateX(-100%);
    }
    
    .sidebar.active {
        transform: translateX(0);
    }
    
    .main-content {
        margin-left: 0;
    }
    
    .mobile-menu-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    /* Fix for mobile sidebar not closing when clicking nav items */
    .nav-item {
        padding: 15px;
        font-size: 1rem;
        -webkit-tap-highlight-color: transparent;
        user-select: none;
    }
    
    /* Better table scrolling on mobile */
    .table-container {
        margin: 0 -15px;
        padding: 0 15px;
        width: calc(100% + 30px);
        -webkit-overflow-scrolling: touch;
    }
    
    .transactions-table {
        min-width: 1200px;
        font-size: 0.9rem;
    }
    
    .transactions-table th,
    .transactions-table td {
        padding: 12px 8px;
        min-height: 50px;
    }
    
    .transactions-table .btn {
        padding: 10px 15px !important;
        min-height: 40px;
        min-width: 70px;
        font-size: 0.9rem !important;
    }
}

@media (max-width: 768px) {
    .top-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
        padding: 15px 20px;
    }
    
    .header-actions {
        width: 100%;
        justify-content: space-between;
    }
    
    .content-wrapper {
        padding: 20px;
    }
    
    .section-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
        padding: 15px 20px;
    }
    
    .section-content {
        padding: 20px;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .modal-actions {
        flex-direction: column;
    }
    
    .receipt-details {
        grid-template-columns: 1fr;
    }
    
    .receipt-amount .amount {
        font-size: 2.5rem;
    }
    
    /* Search section improvements */
    .bursar-moblie {
        flex-direction: column;
        gap: 20px;
    }
    
    .search-date, 
    .search-term-session {
        width: 100%;
        margin-right: 0;
    }
    
    .search-date input,
    .search-term-session select {
        width: 100%;
        padding: 12px;
        font-size: 1rem;
        margin-bottom: 10px;
    }
    
    .but2, .search-date button, .search-term-session button {
        padding: 12px 20px;
        height: 45px;
        min-width: 120px;
        font-size: 1rem;
        margin-top: 5px;
    }
    
    .btn3 {
        width: 100%;
        margin: 5px 0;
        padding: 12px;
        height: 45px;
    }
    
    /* Fix for the overflow issue you added */
    #transactions-section, 
    #outgoing-transactions-section {
        overflow-x: auto;
        overflow-y: visible;
    }
}

@media (max-width: 480px) {
    .content-wrapper {
        padding: 15px;
    }
    
    .form-actions {
        flex-direction: column;
    }
    
    .btn {
        width: 100%;
    }
    
    .receipt {
        padding: 20px;
    }
    
    /* Mobile menu toggle improvements */
    .mobile-menu-toggle {
        width: 60px;
        height: 60px;
        top: 10px;
        left: 10px;
        font-size: 1.8rem;
    }
    
    /* Table improvements for very small screens */
    .transactions-table {
        font-size: 0.8rem;
    }
    
    .transactions-table th,
    .transactions-table td {
        padding: 10px 6px;
    }
    
    .type-badge, .status-badge {
        padding: 6px 10px;
        font-size: 0.8rem;
        min-width: 60px;
    }
}

/* Additional mobile optimizations */
@media (max-width: 992px) {
    /* Ensure the sidebar closes when clicking nav items */
    .sidebar {
        transition: transform 0.3s ease;
    }
    
    /* Make sure content is visible when sidebar is hidden */
    .main-content {
        width: 100%;
    }
    
    /* Improve touch targets */
    .nav-item {
        padding: 15px 20px;
        margin-bottom: 8px;
    }
    
    .nav-item i {
        font-size: 1.3rem;
        width: 30px;
    }
    
    /* Better button sizing for mobile */
    .btn, .but2 {
        min-height: 50px;
        padding: 14px 20px;
    }
    
    /* Form improvements */
    .form-group input,
    .form-group select,
    .form-group textarea {
        padding: 14px;
        font-size: 1rem;
    }
    
    /* Transaction table mobile scroll improvements */
    .table-container::-webkit-scrollbar {
        height: 8px;
    }
    
    .table-container::-webkit-scrollbar-thumb {
        background-color: var(--primary);
        border-radius: 4px;
    }
}

/* Touch-friendly improvements */
@media (hover: none) and (pointer: coarse) {
    .nav-item:active {
        background-color: rgba(255, 255, 255, 0.2);
        transform: scale(0.98);
    }
    
    .btn:active,
    .but2:active {
        transform: scale(0.98);
        opacity: 0.9;
    }
    
    .transactions-table tr:active {
        background-color: rgba(0, 0, 0, 0.05);
    }
}

/* Prevent text selection on mobile */
@media (max-width: 992px) {
    .nav-item, .btn, .but2, .transactions-table td {
        -webkit-tap-highlight-color: transparent;
        user-select: none;
    }
}

/* Mobile menu toggle position fix */
@media (max-width: 992px) {
    .mobile-menu-toggle {
        position: fixed;
        top: 15px;
        left: 15px;
        z-index: 1100;
        background-color: var(--primary);
        color: white;
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 8px;
        font-size: 1.5rem;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
}

/* Fix for section content padding on mobile */
@media (max-width: 768px) {
    #transactions-section .section-content,
    #outgoing-transactions-section .section-content {
        padding: 20px 0;
    }
}
                       
    </style>
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <div class="dashboard-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <h2><i class="fas fa-wallet"></i> Bursar</h2>
                <p style="color: rgba(255,255,255,0.7); font-size: 0.9rem; margin-top: 5px;">Financial Dashboard</p>
            </div>
            
            <nav class="nav-menu">
                <a href="#dashboard" class="nav-item active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
                <a href="#income" class="nav-item" onclick="showSection('income')">
                    <i class="fas fa-plus-circle"></i> Income Payment
                </a>
                <a href="#outcome" class="nav-item" onclick="showSection('outcome')">
                    <i class="fas fa-minus-circle"></i> Outcome Payment
                </a>
                <a href="#transactions" class="nav-item" onclick="showSection('transactions')">
                    <i class="fas fa-arrow-down" style="color: greenyellow;"></i>Income Transactions
                </a>
                <!-- wants to add another section for outgoing transactions -->
                <a href="#outgoing-transactions" class="nav-item" onclick="showSection('outgoing-transactions')">
                    <i class="fas fa-arrow-up" style="color: red;"></i>Outcome Transactions
                </a>
                <a href="./trace.html" class="nav-item">
                    <i class="fas fa-receipt"></i> Transaction Record
                </a>
                <a href="./fixed-fees.html" class="nav-item">
                    <i class="fas fa-chart-bar"></i> Fixed Fees
                </a>
                <a href="#settings" class="nav-item" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i> Settings
                </a>
            </nav>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Header -->
            <div class="top-header">
                <div class="header-title">
                    <h3>Bursar Dashboard</h3>
                    <p id="currentDate">Welcome, Bursar | Financial Year: 2023-2024</p>
                </div>
                
                <div class="header-actions">
                    <div class="user-profile">
                        <div class="user-avatar" id="profile-picute">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div>
                            <h4 style="color: var(--primary);" id="profile-name"></h4>
                            <p style="color: var(--gray); font-size: 0.9rem;">Bursar</p>
                        </div>
                    </div>
                    
                    <button class="logout-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
            
            <!-- Content Wrapper -->
            <div class="content-wrapper">
                <!-- Dashboard Section -->
                <section class="section active" id="dashboard-section">
                    <div class="section-header">
                        <h2><i class="fas fa-tachometer-alt"></i> Financial Dashboard</h2>
                        <div class="section-badge">Today's Summary</div>
                    </div>
                    
                    <div class="section-content">
                        <div class="stats-grid">
                            <div class="stat-card income">
                                <div class="stat-icon income">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="incomeTotal"></h3>
                                    <p>Total Income</p>
                                </div>
                            </div>
                            
                            <div class="stat-card outcome">
                                <div class="stat-icon outcome">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="outcomeTotal"></h3>
                                    <p>Total Outcome</p>
                                </div>
                            </div>
                            
                            <div class="stat-card balance">
                                <div class="stat-icon balance">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <div class="stat-info">
                                    <h3 id="balanceTotal"></h3>
                                    <p>Current Balance</p>
                                </div>
                            </div>
                        </div>
                        
                        <div style="background-color: var(--light); border-radius: 10px; padding: 25px; margin-top: 20px;">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">Quick Actions</h3>
                            <div style="display: flex; flex-wrap: wrap; gap: 15px;">
                                <button class="btn btn-success" onclick="showSection('income')">
                                    <i class="fas fa-plus-circle"></i> Record Income
                                </button>
                                <button class="btn btn-danger" onclick="showSection('outcome')">
                                    <i class="fas fa-minus-circle"></i> Record Outcome
                                </button>
                                <button class="btn btn-primary" onclick="showSection('transactions')">
                                    <i class="fas fa-exchange-alt"></i> View Transactions
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Income Payment Section -->
<section class="section" id="income-section">
                    <div class="section-header">
                        <h2><i class="fas fa-plus-circle"></i> Income Payment</h2>
                        <div class="section-badge">Record New Income</div>
                    </div>
                    
                    <div class="section-content">
                        <div class="form-container">
                            <form  id="incomeForm" onsubmit="recordPayment(event, 'income')">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="incomeAmount">Admission Number</label>
                                        <input type="text" id="admission_number" name="admission_number" step="0.01" min="0" required placeholder="NSD-78378/848">
                                    </div>
                                    <div class="form-group">
                                        <label for="incomeAmount">Name</label>
                                        <input type="text" id="name" name="name" step="0.01" min="0" required placeholder="Fin Kelly">
                                    </div>
                                    <div class="form-group">
                                    <label for="incomeAmount">Class</label>
                                       <select class="filter-select" id="class">
                                            <option value="">Select class</option>
                                            <option value="SS3-Science">SS3-Science</option>
                                            <option value="SS3-Commercial">SS3-Commercial</option>
                                            <option value="SS3-ART">SS3-ART</option>
                                            <option value="SS2-Science">SS2-Science</option>
                                            <option value="SS3-Commercial">SS2-Commercial</option>
                                            <option value="SS2-ART">SS2-ART</option>
                                            <option value="SS1-Science">SS1-Science</option>
                                            <option value="SS1-Commercial">SS1-Commercial</option>
                                            <option value="SS1-ART">SS1-ART</option>
                                            <option value="JSS3">JSS3</option>
                                            <option value="JSS2">JSS2</option>
                                            <option value="JSS1">JSS1</option>
                                            <option value="PRY5">PRY5</option>
                                            <option value="PRY4">PRY4</option>
                                            <option value="PRY3">PRY3</option>
                                            <option value="PRY2">PRY2</option>
                                            <option value="PRY1">PRY1</option>
                                            <option value="NUR2">NUR2</option>
                                            <option value="NUR1">NUR1</option>
                                            <option value="KG1">KG1</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="incomeAmount">Amount (#)</label>
                                        <input type="number" id="incomeAmount" step="0.01" min="0" required placeholder="0.00">
                                    </div>
                                    <div class="form-group">
                                        <label for="incomePayer">Payer Name</label>
                                        <input type="text" id="incomePayer" required placeholder="Enter payer name">
                                    </div>
                                    <div class="form-group">
                                        <label for="">Receiver</label>
                                        <select name="receiver" id="receiver">
                                            <option value="">select receiver</option>
                                            <option value="Bursar">Bursar</option>
                                            <option value="Surbordinate">Surbordinate</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="incomeAmount">If Surbordinate</label>
                                        <input type="text" id="Surbordinate-name" placeholder="Enter Surbordinate none" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="incomeCategory">Category</label>
                                        <select id="incomeCategory" required>
                                            <option value="">Select category</option>
                                            <option value="School-fee">School Fees</option>
                                            <option value="school-uniform">School Uniform</option>
                                            <option value="school-sporty-ware">school sporty ware</option>
                                            <option value="end-of-the-year-party">End of the year party</option>
                                            <option value="accodation-fee">Accodation Fee</option>
                                            <option value="Lab-fee">Laboratory fee</option>
                                            <option value="registration">Registration Fees</option>
                                            <option value="exam">Examination Fees</option>
                                            <option value="external-exam">external-exam</option>
                                            <option value="other">Other fees</option>
                                        </select>
                                    </div>
                                     <div class="form-group">
                                        <label for="incomeAmount">Current Session</label>
                                         <select name="session" id="session" class="btn">
                                            <option value="">Select Current session</option>
                                            <option value="2025/2026">2025/2026</option>
                                            <option value="2026/2027">2026/2027</option>
                                            <option value="2027/2028">2027/2028</option>
                                            <option value="2028/2029">2028/2029</option>
                                            <option value="2029/2030">2029/2030</option>
                                         </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="">Term</label>
                                        <select name="term" id="term" class="btn">
                                            <option value="">select current term</option>
                                            <option value="first">first term</option>
                                            <option value="second">second term</option>
                                            <option value="third">third term</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="">week</label>
                                        <select name="week" id="week" class="btn">
                                            <option value="">select current week</option>
                                            <!-- <option value="all weeks">All weeks</option> -->
                                            <option value="week-1">week 1</option>
                                            <option value="week-2">week 2</option>
                                            <option value="week-3">week 3</option>
                                            <option value="week-4">week 4</option>
                                            <option value="week-5">week 5</option>
                                            <option value="week-6">week 6</option>
                                            <option value="week-7">week 7</option>
                                            <option value="week-8">week 8</option>
                                            <option value="week-9">week 9</option>
                                            <option value="week-10">week 10</option>
                                            <option value="week-11">week 11</option>
                                            <option value="week-12">week 12</option>
                                            <option value="week-13">week 13</option>
                                            <option value="week-14">week 14</option>
                                            <option value="week-15">week 15</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="incomePaymentMethod">Payment Method</label>
                                        <select id="incomePaymentMethod" required>
                                            <option value="">Select method</option>
                                            <option value="cash">Cash</option>
                                            <option value="bank">Bank Transfer</option>
                                            <option value="check">Check</option>
                                            <option value="card">Card</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="incomeDescription">Description</label>
                                    <textarea id="incomeDescription" rows="3" placeholder="Payment description"></textarea>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="button" class="btn btn-secondary" onclick="resetForm('incomeForm')">
                                        <i class="fas fa-redo"></i> Reset
                                    </button>
                                    <button type="submit" class="btn btn-success">
                                        <i class="fas fa-save"></i> Record Payment
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>
                
                <!-- Outcome Payment Section -->
                <section class="section" id="outcome-section">
                    <div class="section-header">
                        <h2><i class="fas fa-minus-circle"></i> Outcome Payment</h2>
                        <div class="section-badge">Record New Outcome</div>
                    </div>
                    
                    <div class="section-content">
                        <div class="form-container">
                            <form id="outcomeForm" enctype="multipart/form-data" onsubmit="recordOutComePayment(event, 'outcome')">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="outcomeAmount">Amount (#)</label>
                                        <input type="number" id="outcomeAmount" step="0.01" min="0" required placeholder="0.00">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="outcomePayee">Payer Name</label>
                                        <select name="receiver" id="outcomePayee">
                                            <option value="">select receiver</option>
                                            <option value="Bursar">Bursar</option>
                                            <option value="Surbordinate">Surbordinate</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="outcomePayee">Proval Name</label>
                                        <input type="text" id="Proval_name" required placeholder="Enter payee name">
                                    </div>
                                </div>
                                <div class="form-group">
                                        <label for="">Receiver</label>
                                        <input type="text" id="outComereceiver">
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="outcomeCategory">Category</label>
                                        <select id="outcomeCategory" required>
                                            <option value="">Select category</option>
                                            <option value="salaries">Salaries</option>
                                            <option value="utilities">Utilities</option>
                                            <option value="supplies">Supplies</option>
                                            <option value="maintenance">Maintenance</option>
                                            <option value="services">Services</option>
                                            <option value="other">Other Expense</option>
                                        </select>
                                    </div>
                                     <div class="form-group">
                                        <label for="">week</label>
                                        <select name="week" id="outComeweek" class="btn">
                                            <option value="">select current week</option>
                                            <!-- <option value="all weeks">All weeks</option> -->
                                            <option value="week-1">week 1</option>
                                            <option value="week-2">week 2</option>
                                            <option value="week-3">week 3</option>
                                            <option value="week-4">week 4</option>
                                            <option value="week-5">week 5</option>
                                            <option value="week-6">week 6</option>
                                            <option value="week-7">week 7</option>
                                            <option value="week-8">week 8</option>
                                            <option value="week-9">week 9</option>
                                            <option value="week-10">week 10</option>
                                            <option value="week-11">week 11</option>
                                            <option value="week-12">week 12</option>
                                            <option value="week-13">week 13</option>
                                            <option value="week-14">week 14</option>
                                            <option value="week-15">week 15</option>
                                        </select>
                                    </div>
                                     <div class="form-group">
                                        <label for="incomeAmount">Current Session</label>
                                         <select name="session" id="outcomesession" class="btn">
                                            <option value="">Select Current session</option>
                                            <option value="2025/2026">2025/2026</option>
                                            <option value="2026/2027">2026/2027</option>
                                            <option value="2027/2028">2027/2028</option>
                                            <option value="2028/2029">2028/2029</option>
                                            <option value="2029/2030">2029/2030</option>
                                         </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="">Term</label>
                                        <select name="term" id="outcometerm" class="btn">
                                            <option value="">select current term</option>
                                            <option value="first">first term</option>
                                            <option value="second">second term</option>
                                            <option value="third">third term</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="outcomePaymentMethod">Payment Method</label>
                                        <select id="outcomePaymentMethod" required>
                                            <option value="">Select method</option>
                                            <option value="cash">Cash</option>
                                            <option value="bank">Bank Transfer</option>
                                            <option value="check">Check</option>
                                            <option value="card">Card</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="">Upload Receipt(Optional)</label>
                                        <input type="file" id="receipt" accept="image/*">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="outcomeDescription">Description</label>
                                    <textarea id="outcomeDescription" rows="3" placeholder="Payment description"></textarea>
                                </div>
                                
                                <div class="form-actions">
                                    <button type="button" class="btn btn-secondary" onclick="resetForm('outcomeForm')">
                                        <i class="fas fa-redo"></i> Reset
                                    </button>
                                    <button type="submit" class="btn btn-danger">
                                        <i class="fas fa-save"></i> Record Payment
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </section>
                
                <!-- Transactions Section -->
                <section class="section" id="transactions-section">
                    <div class="section-header">
                        <h2><i class="fas fa-arrow-down" style="color: greenyellow;"></i>Income Transactions</h2>
                        <div class="section-badge">Recent Income Transactions</div>
                    </div>
                    
                <div class="bursar-moblie">
                            <div class="search-date">
                                <label for="">Enter a particular day</label><br>
                                <input type="text" name="date" id="date" class="btn3" placeholder="enetr a date" style="border-style: solid; border-width: thin;"><br>
                                <span>Use this formart <i>2026-6-9</i></span><br>
                                <button onclick="transcation()" class=" but2" style="background-color: #1e3a6f;width: 120px; height: 25px;" >search</button>
                            </div>
                             <div id="display-transcation-error">

                                </div>
                            <div class="search-term-session">
                                <label for="">Search for particular term and session</label> <br>
                                <select name="session" id="session-search" class="btn3">
                                    <option value="">Select session</option>
                                    <option value="2025/2026">2025/2026</option>
                                    <option value="2026/2027">2026/2027</option>
                                    <option value="2027/2028">2027/2028</option>
                                    <option value="2028/2029">2028/2029</option>
                                    <option value="2029/2030">2029/2030</option>
                                </select>
                                <select name="term" id="term-search" class="btn3">
                                    <option value="">select term</option>
                                    <option value="first">first term</option>
                                    <option value="second">second term</option>
                                    <option value="third">third term</option>
                                </select><br>
                                <select name="week" id="week-search" class="btn3">
                                    <option value="">select week</option>
                                    <option value="all weeks">All weeks</option>
                                    <option value="week-1">week 1</option>
                                    <option value="week-2">week 2</option>
                                    <option value="week-3">week 3</option>
                                    <option value="week-4">week 4</option>
                                    <option value="week-5">week 5</option>
                                    <option value="week-6">week 6</option>
                                    <option value="week-7">week 7</option>
                                    <option value="week-8">week 8</option>
                                    <option value="week-9">week 9</option>
                                    <option value="week-10">week 10</option>
                                    <option value="week-11">week 11</option>
                                    <option value="week-12">week 12</option>
                                    <option value="week-13">week 13</option>
                                    <option value="week-14">week 14</option>
                                    <option value="week-15">week 15</option>
                                </select><br>
                                <button onclick="transca()" class="but2" style="background-color: #1e3a6f;width: 120px; height: 25px;">search</button>
                              
                                
                           </div>
                     </div>

                    <div class="section-content">
                        <div class="table-container">
                            <table class="transactions-table">
                                <thead>
                                    <tr>
                                        <th>Transaction ID</th>
                                        <th>Date</th>
                                        <th>Time</th>
                                        <th>Name</th>
                                        <th>Class</th>
                                        <th>Type</th>
                                        <th>Description</th>
                                        <th>Amount</th>
                                        <th>Category</th>
                                        <th>Party</th>
                                         <th>Sender</th>
                                        <th>Method</th>
                                        <th>Week</th>
                                        <th>Term</th>
                                        <th>Session</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="transactionsTable">
                                    
                                    <!-- Transactions will be populated here -->
                                </tbody>
                                <div class="total-money-term-session-display">
                                    <h4 id="total-money-term-session"></h4>
                                </div>
                            </table>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button class="btn btn-primary" id="loadmorebtn">
                                <i class="fas fa-sync-alt"></i> Load More
                            </button>
                        </div>
                    </div>
                </section>
                <!-- section for outgoing transactions -->
                <section class="section" id="outgoing-transactions-section">
                    <div class="section-header">
                        <h2><i class="fas fa-arrow-up" style="color: red;"></i> Outcome Transactions</h2>
                        <div class="section-badge">Recent Outcome Transactions</div>
                    </div>
                     <div class="bursar-moblie">
                            <div class="search-date">
                                <label for="">Enter a particular day</label><br>
                                <input type="text" name="date" id="date-expenses" class="btn3" placeholder="enetr a date" style="border-style: solid; border-width: thin;"><br>
                                <span>Use this formart <i>2026-6-9</i></span><br>
                                <button onclick="transcationExpenses()" class=" but2" style="background-color: #1e3a6f;width: 120px; height: 25px;" >search</button>
                            </div>
                             <div id="display-transcation-error">

                                </div>
                            <div class="search-term-session">
                                <label for="">Search for particular term and session</label> <br>
                                <select name="session" id="session-search-expenses"class="btn3">
                                    <option value="">Select session</option>
                                    <option value="2025/2026">2025/2026</option>
                                    <option value="2026/2027">2026/2027</option>
                                    <option value="2027/2028">2027/2028</option>
                                    <option value="2028/2029">2028/2029</option>
                                    <option value="2029/2030">2029/2030</option>
                                </select>
                                <select name="term" id="term-search-expenses" class="btn3">
                                    <option value="">select term</option>
                                    <option value="first">first term</option>
                                    <option value="second">second term</option>
                                    <option value="third">third term</option>
                                </select><br>
                                <select name="week" id="week-search-expenses" class="btn3">
                                    <option value="">select week</option>
                                    <option value="all weeks">All weeks</option>
                                    <option value="week-1">week 1</option>
                                    <option value="week-2">week 2</option>
                                    <option value="week-3">week 3</option>
                                    <option value="week-4">week 4</option>
                                    <option value="week-5">week 5</option>
                                    <option value="week-6">week 6</option>
                                    <option value="week-7">week 7</option>
                                    <option value="week-8">week 8</option>
                                    <option value="week-9">week 9</option>
                                    <option value="week-10">week 10</option>
                                    <option value="week-11">week 11</option>
                                    <option value="week-12">week 12</option>
                                    <option value="week-13">week 13</option>
                                    <option value="week-14">week 14</option>
                                    <option value="week-15">week 15</option>
                                </select><br>
                                <button onclick="transcaExpenses()" class="but2" style="background-color: #1e3a6f;width: 120px; height: 25px;">search</button>
                              
                                
                           </div>
                     </div>
                    <div class="section-content">
                        <div class="table-container">
                            <table class="transactions-table">
                                <thead>
                                    <tr>
                                        <th>Transaction ID</th>
                                        <th>Date</th>
                                        <th>Time</th>
                                        <th>Approval</th>
                                        <th>Amount</th>
                                        <th>Type</th>
                                        <th>Description</th>
                                        <th>Category</th>
                                        <th>Receiver</th>
                                         <th>Sender</th>
                                        <th>Method</th>
                                        <th>Week</th>
                                        <th>Term</th>
                                        <th>Session</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="outgoingTransactionsTable">
                                    
                                    <!-- Outcome Transactions will be populated here -->
                                </tbody>
                                <div class="total-money-term-session-display">
                                    <h4 id="total-money-term-session"></h4>
                                </div>
                            </table>
                        </div>
                        
                        <div style="text-align: center; margin-top: 30px;">
                            <button class="btn btn-primary" id="loadmoreOutgoingBtn">
                                <i class="fas fa-sync-alt"></i> Load More
                            </button>
                        </div>
                    </div>
                <!-- Receipts Section -->
                <section class="section" id="receipts-section">
                    <div class="section-header">
                        <h2><i class="fas fa-receipt"></i> Receipts</h2>
                        <div class="section-badge">Issued Receipts</div>
                    </div>
                    
                    <div class="section-content">
                        <div style="background-color: var(--light); border-radius: 10px; padding: 25px; margin-bottom: 30px;">
                            <h3 style="color: var(--primary); margin-bottom: 15px;">Recent Receipts</h3>
                            <div id="receiptsList">
                                <!-- Receipts will be listed here -->
                            </div>
                        </div>
                        
                        <div style="text-align: center;">
                            <button class="btn btn-primary" onclick="generateSampleReceipt()">
                                <i class="fas fa-file-invoice"></i> Generate Sample Receipt
                            </button>
                        </div>
                    </div>
                </section>
                
                <!-- Reports Section -->
                <section class="section" id="reports-section">
                    <div class="section-header">
                        <h2><i class="fas fa-chart-bar"></i> Reports</h2>
                        <div class="section-badge">Financial Reports</div>
                    </div>
                    
                    <div class="section-content">
                        <div style="text-align: center; padding: 50px 20px;">
                            <i class="fas fa-chart-pie" style="font-size: 4rem; color: var(--primary); margin-bottom: 20px;"></i>
                            <h3 style="color: var(--primary); margin-bottom: 15px;">Financial Reports</h3>
                            <p style="color: var(--gray); margin-bottom: 30px;">Generate detailed financial reports for analysis and record keeping.</p>
                            <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center;">
                                <button class="btn btn-primary">
                                    <i class="fas fa-file-pdf"></i> Income Report
                                </button>
                                <button class="btn btn-primary">
                                    <i class="fas fa-file-excel"></i> Expense Report
                                </button>
                                <button class="btn btn-primary">
                                    <i class="fas fa-chart-line"></i> Balance Sheet
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Settings Section -->
                <section class="section" id="settings-section">
                    <div class="section-header">
                        <h2><i class="fas fa-cog"></i> Settings</h2>
                        <div class="section-badge">System Settings</div>
                    </div>
                    
                    <div class="section-content">
                        <div style="max-width: 600px; margin: 0 auto;">
                            <div style="background-color: var(--light); border-radius: 10px; padding: 25px; margin-bottom: 20px;">
                                <h3 style="color: var(--primary); margin-bottom: 20px;">Account Settings</h3>
                                <div class="form-group">
                                    <label>Bursar Name</label>
                                    <input type="text" value="Mr. James Wilson" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Email Address</label>
                                    <input type="email" value="bursar@newdich.edu" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label>Financial Year</label>
                                    <input type="text" value="2023-2024" class="form-control">
                                </div>
                                <button class="btn btn-primary" style="margin-top: 10px;">
                                    <i class="fas fa-save"></i> Save Changes
                                </button>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
    





    
    <!-- Receipt Modal -->
    <div class="modal" id="receiptModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Payment Receipt</h3>
                <button class="close-btn" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="receipt" id="receiptContent">
                    <!-- Receipt content will be inserted here -->
                </div>
                
                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="closeModal()">
                        <i class="fas fa-times"></i> Close
                    </button>
                    <button class="btn btn-primary" onclick="printReceipt()">
                        <i class="fas fa-print"></i> Print Receipt
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div class="modal" id="confirmModal">
        <div class="modal-content confirm-modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle"></i> Confirm Payment</h3>
                <button class="close-btn" onclick="closeConfirmModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <i class="fas fa-question-circle" style="font-size: 4rem; color: var(--warning);"></i>
                    <h3 style="color: var(--primary); margin: 15px 0;">Please Confirm Payment Details</h3>
                    <p style="color: var(--gray);">Review the details below before proceeding</p>
                </div>
                
                <div class="confirm-details" id="confirmDetails">
                    <!-- Confirmation details will be inserted here -->
                </div>
                
                <div class="confirm-highlight" id="confirmAmount">
                    <!-- Amount will be inserted here -->
                </div>
                
                <div class="modal-actions">
                    <button class="btn btn-secondary" onclick="closeConfirmModal()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button class="btn btn-success" id="confirmSaveBtn">
                        <i class="fas fa-check"></i> Confirm & Save
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Simplified JavaScript -->
    <script>
        // When page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Set today's date in header
            const today = new Date();
            const dateStr = today.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            document.getElementById('currentDate').textContent = `Welcome, Bursar | Today: ${dateStr}`;
            
            // Load initial data
            loadTransactions();
            loadReceipts();
            
            // Mobile menu toggle
            document.getElementById('mobileMenuToggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('active');
            });
        });
        
        // Switch between sections
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId + '-section').classList.add('active');
            
            // Update active menu item
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item.getAttribute('href') === '#' + sectionId) {
                    item.classList.add('active');
                }
            });
            
            // Close mobile menu on mobile
            if (window.innerWidth <= 992) {
                document.getElementById('sidebar').classList.remove('active');
            }
        }
        
        // Show confirmation modal when form is submitted
        function recordPayment(event, type) {
            event.preventDefault();
            
              let amount, party, category, description, paymentMethod, classes, name, admission_number, session, term, week, Surbordinate;
            
            if (type === 'income') {
                amount = document.getElementById('incomeAmount').value;
                party = document.getElementById('incomePayer').value;
                category = document.getElementById('incomeCategory').value;
                description = document.getElementById('incomeDescription').value || 'No description';
                paymentMethod = document.getElementById('incomePaymentMethod').value;
                classes = document.getElementById('class').value;
                name = document.getElementById('name').value;
                admission_number = document.getElementById('admission_number').value;
                session = document.getElementById('session').value;
                term = document.getElementById('term').value;
                week = document.getElementById('week').value;
                receiver = document.getElementById('receiver').value;
                Surbordinate_name=document.getElementById("Surbordinate-name").value;
                receipt = document.getElementById('receipt').value;
            } else {
                amount = document.getElementById('outcomeAmount').value;
                party = document.getElementById('outcomePayee').value;
                category = document.getElementById('outcomeCategory').value;
                description = document.getElementById('outcomeDescription').value || 'No description';
                paymentMethod = document.getElementById('outcomePaymentMethod').value;
                classes = document.getElementById('class').value;
                name = document.getElementById('name').value;
                admission_number = document.getElementById('admission_number').value;
                session = document.getElementById('session').value;
                term = document.getElementById('term').value;
                week = document.getElementById('week').value;
                receiver = document.getElementById('receiver').value;
                Surbordinate_name=document.getElementById("Surbordinate-name").value;
                receipt = document.getElementById('receipt').value;
            }
            
            // Basic validation
            if (parseFloat(amount) <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (!amount || !party || !category || !paymentMethod) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Show confirmation modal
            showConfirmationModal({
                type: type,
                amount: amount,
                party: party,
                category: category,
                description: description,
                paymentMethod: paymentMethod,
                classes: classes,
                name:name,
                admission_number:admission_number,
                session:session,
                term:term,
                week:week,
                receiver,
                Surbordinate_name:Surbordinate_name,
                receipt:receipt
            });
        }
        
        // show confirmation modal for outcome 

    function recordOutComePayment(event, type) {
            event.preventDefault();
            
              let amount, party, category, description, paymentMethod, name,  session, term, week, Surbordinate, approval, receipt;
            if (type === 'outcome') {
                amount = document.getElementById('outcomeAmount').value;
                party = document.getElementById('outcomePayee').value;
                category = document.getElementById('outcomeCategory').value;
                description = document.getElementById('outcomeDescription').value || 'No description';
                paymentMethod = document.getElementById('outcomePaymentMethod').value;
                session = document.getElementById('outcomesession').value;
                term = document.getElementById('outcometerm').value;
                week = document.getElementById('outComeweek').value;
                receiver = document.getElementById('outComereceiver').value;
                Surbordinate_name=document.getElementById("Surbordinate-name").value;
                approval = document.getElementById('Proval_name').value;
                const getreceipt =  document.getElementById('receipt');
                const file = getreceipt.files[0];
                receipt = file;
            }
            

            
            // Basic validation
            if (parseFloat(amount) <= 0) {
                alert('Please enter a valid amount');
                return;
            }
            
            if (!amount || !party || !category || !paymentMethod) {
                alert('Please fill in all required fields');
                return;
            }
            
            // Show confirmation modal
            showConfirmationModalOutCome({
                type: type,
                amount: amount,
                party: party,
                category: category,
                description: description,
                paymentMethod: paymentMethod,
                session:session,
                term:term,
                week:week,
                receiver,
                Surbordinate_name:Surbordinate_name,
                approval:approval,
                receiver:receiver,
                receipt:receipt
            });
        }

        function showConfirmationModalOutCome(data) {
            // Category names
            const categoryNames = {
                tuition: 'Tuition Fees',
                registration: 'Registration Fees',
                exam: 'Examination Fees',
                donation: 'Donation',
                grant: 'Grant',
                salaries: 'Salaries',
                utilities: 'Utilities',
                supplies: 'Supplies',
                maintenance: 'Maintenance',
                services: 'Services',
                other: data.type === 'income' ? 'Other Income' : 'Other Expense'
            };
            
            // Payment method names
            const methodNames = {
                cash: 'Cash',
                bank: 'Bank Transfer',
                check: 'Check',
                card: 'Credit/Debit Card'
            };
            
            // Build confirmation details
            const detailsHTML = `
                 <div class="confirm-item">
                    <span class="confirm-label">Transaction Type:</span>
                    <span class="confirm-value" style="color: ${data.type === 'income' ? 'var(--success)' : 'var(--danger)'}">
                        ${data.type === 'income' ? 'INCOME' : 'OUTCOME'} 
                        <i class="fas fa-${data.type === 'income' ? 'plus-circle' : 'minus-circle'}"></i>
                    </span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">${data.type === 'income' ? 'Payer' : 'Payer'}:</span>
                    <span class="confirm-value">${data.party}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Approval Name:</span>
                    <span class="confirm-value">${data.approval}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Category:</span>
                    <span class="confirm-value">${data.category}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Session:</span>
                    <span class="confirm-value">${data.session}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Term:</span>
                    <span class="confirm-value">${data.term}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Week:</span>
                    <span class="confirm-value">${data.week}</span>
                </div>
                 <div class="confirm-item">
                    <span class="confirm-label">Receiver:</span>
                    <span class="confirm-value">${data.receiver}</span>
                </div>
                 <div class="confirm-item">
                    <span class="confirm-label">Subordate:</span>
                    <span class="confirm-value">${data.Surbordinate_name}</span>
                </div>
                 <div class="confirm-item">
                    <span class="confirm-label">Payment Method:</span>
                    <span class="confirm-value">${methodNames[data.paymentMethod] || data.paymentMethod}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Description:</span>
                    <span class="confirm-value">${data.description}</span>
                </div>
            `;
            
            // Display confirmation details
            document.getElementById('confirmDetails').innerHTML = detailsHTML;
            document.getElementById('confirmAmount').innerHTML = `
                <div>${data.type === 'income' ? 'Amount' : 'Amount'}</div>
                <div style="font-size: 2rem; margin-top: 10px;">${parseFloat(data.amount).toLocaleString('NGN-ng', {minimumFractionDigits: 2})}</div>
            `;
            
            // Setup confirm button
            const confirmBtn = document.getElementById('confirmSaveBtn');
            confirmBtn.onclick = function() {
                closeConfirmModal();
                savePaymentOutCome(data);
            };
            
            // Set button color based on type
            if (data.type === 'income') {
                confirmBtn.className = 'btn btn-success';
                confirmBtn.innerHTML = '<i class="fas fa-check"></i>  Confirm & Record Income';
            } else {
                confirmBtn.className = 'btn btn-danger';
                confirmBtn.innerHTML = '<i class="fas fa-check"></i> Confirm & Record Outcome';
            }
            
            // Show modal
            document.getElementById('confirmModal').classList.add('active');
        }

        // Show confirmation modal with all details
        function showConfirmationModal(data) {
            // Category names
            const categoryNames = {
                tuition: 'Tuition Fees',
                registration: 'Registration Fees',
                exam: 'Examination Fees',
                donation: 'Donation',
                grant: 'Grant',
                salaries: 'Salaries',
                utilities: 'Utilities',
                supplies: 'Supplies',
                maintenance: 'Maintenance',
                services: 'Services',
                other: data.type === 'income' ? 'Other Income' : 'Other Expense'
            };
            
            // Payment method names
            const methodNames = {
                cash: 'Cash',
                bank: 'Bank Transfer',
                check: 'Check',
                card: 'Credit/Debit Card'
            };
            
            // Build confirmation details
            const detailsHTML = `
                 <div class="confirm-item">
                    <span class="confirm-label">Transaction Type:</span>
                    <span class="confirm-value" style="color: ${data.type === 'income' ? 'var(--success)' : 'var(--danger)'}">
                        ${data.type === 'income' ? 'INCOME' : 'OUTCOME'} 
                        <i class="fas fa-${data.type === 'income' ? 'plus-circle' : 'minus-circle'}"></i>
                    </span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">${data.type === 'income' ? 'Payer' : 'Payer'}:</span>
                    <span class="confirm-value">${data.party}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Name:</span>
                    <span class="confirm-value">${data.name}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Admission Number</span>
                    <span class="confirm-value">${data.admission_number}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Class:</span>
                    <span class="confirm-value">${data.classes}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Category:</span>
                    <span class="confirm-value">${data.category}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Session:</span>
                    <span class="confirm-value">${data.session}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Term:</span>
                    <span class="confirm-value">${data.term}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Week:</span>
                    <span class="confirm-value">${data.week}</span>
                </div>
                 <div class="confirm-item">
                    <span class="confirm-label">Receiver:</span>
                    <span class="confirm-value">${data.receiver}</span>
                </div>
                 <div class="confirm-item">
                    <span class="confirm-label">Subordate:</span>
                    <span class="confirm-value">${data.Surbordinate_name}</span>
                </div>
                 <div class="confirm-item">
                    <span class="confirm-label">Payment Method:</span>
                    <span class="confirm-value">${methodNames[data.paymentMethod] || data.paymentMethod}</span>
                </div>
                <div class="confirm-item">
                    <span class="confirm-label">Description:</span>
                    <span class="confirm-value">${data.description}</span>
                </div>
            `;
            
            // Display confirmation details
            document.getElementById('confirmDetails').innerHTML = detailsHTML;
            document.getElementById('confirmAmount').innerHTML = `
                <div>${data.type === 'income' ? 'Amount' : 'Amount'}</div>
                <div style="font-size: 2rem; margin-top: 10px;">${parseFloat(data.amount).toLocaleString('NGN-ng', {minimumFractionDigits: 2})}</div>
            `;
            
            // Setup confirm button
            const confirmBtn = document.getElementById('confirmSaveBtn');
            confirmBtn.onclick = function() {
                closeConfirmModal();
                savePayment(data);
            };
            
            // Set button color based on type
            if (data.type === 'income') {
                confirmBtn.className = 'btn btn-success';
                confirmBtn.innerHTML = '<i class="fas fa-check"></i> Confirm & Record Income';
            } else {
                confirmBtn.className = 'btn btn-danger';
                confirmBtn.innerHTML = '<i class="fas fa-check"></i> Confirm & Record Outcome';
            }
            
            // Show modal
            document.getElementById('confirmModal').classList.add('active');
        }
        
        // Save payment after confirmation
        async function savePayment(data) {
            const date = new Date();
            const day = date.getDate();
            const month = date.getMonth() + 1;
            const year = date.getFullYear();
            const all = `${year}-${month}-${day}`;
             const time = new Date();
             const hours = time.getHours();
             const minute = time.getMinutes();
             const allTime  = `${hours}:${minute}`;
             const dataAdin = data.admission_number;
             const subAdmin = dataAdin.substr(5,8);
             const mili = time.getSeconds();
            //  const subtime = ;
             const transaction_id = '234'+subAdmin+'000'+mili+minute;
             console.log(transaction_id);
            const storedata = {
                    type: data.type,
                    amount: data.amount,
                    party: data.party,
                    category: data.category,
                    description: data.description,
                    paymentMethod: data.paymentMethod,
                    classes: data.classes,
                    name:data.name,
                    admission_number:data.admission_number,
                    session:data.session,
                    term:data.term,
                    week:data.week,
                    receiver: data.receiver,
                    Surbordinate_name:data.Surbordinate_name,
                    date:all,
                    time:allTime,
                    transaction_id:transaction_id,
                    receipt:data.receipt
            }

             // DATABASE OPERATION: Send payment data to server
            const api = await fetch('/payment-income', {
                method: 'POST',
                headers:{'Content-type':'application/json'},
                body:JSON.stringify(storedata)
            })
             if(!api.ok){
                if(api.status==404){
                    alert('Admission or name not correct');
                    return;
                }
                if(api.status==400){
                    alert('All field required');
                    return;
                }
             }
             else{
                const result = await api.json();
                const converted = JSON.parse(result);
                if(api.status==200){
                    alert('Payment saved successfully!');
                    console.log(converted);
                    // Update local data
                    updateStats(data.type, parseFloat(data.amount));
                    loadTransactions();
                    generateReceipt(storedata);
                }
                else{
                    alert('transaction failed');
                    return;
                }
             }
        }

             // Save outcome payment after confirmation
        async function savePaymentOutCome(data) {
            const date = new Date();
            const day = date.getDate();
            const month = date.getMonth() + 1;
            const year = date.getFullYear();
            const all = `${year}-${month}-${day}`;
             const time = new Date();
             const hours = time.getHours();
             const minute = time.getMinutes();
             const allTime  = `${hours}:${minute}`;
             const mili = time.getSeconds();
            //  const subtime = ;
             const transaction_id ='345'+'0000'+mili+minute;
             console.log(transaction_id);
            const storedata = {
                    type: data.type,
                    amount: data.amount,
                    party: data.party,
                    category: data.category,
                    description: data.description,
                    paymentMethod: data.paymentMethod,
                    session:data.session,
                    term:data.term,
                    week:data.week,
                    receiver: data.receiver,
                    Surbordinate_name:data.Surbordinate_name,
                    date:all,
                    time:allTime,
                    transaction_id:transaction_id,
                    approval:data.approval,
                    receiver:data.receiver,
                    receipt:data.receipt
            }
            console.log(storedata);
             // DATABASE OPERATION: Send payment data to server
            const api = await fetch('/OutCome-payment', {
                method: 'POST',
                body:JSON.stringify(storedata)
                
            })
             if(!api.ok){
                if(api.status==404){
                    alert('Admission or name not correct');
                    return;
                }
                if(api.status==400){
                    alert('All field required');
                    return;
                }
             }
             else{
                const result = await api.json();
                const converted = JSON.parse(result);
                if(api.status==200){
                    alert('Payment saved successfully!');
                    console.log(converted);
                    // Update local data
                    updateStats(data.type, parseFloat(data.amount));
                    loadTransactions();
                    generateReceiptOutCome(storedata);
                }
                else{
                    alert('transaction failed');
                    return;
                }
             }
            /*
            fetch('/api/transactions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    type: data.type,
                    amount: data.amount,
                    party: data.party,
                    category: data.category,
                    description: data.description,
                    paymentMethod: data.paymentMethod,
                    date: new Date().toISOString()
                })
            })
            .then(response => response.json())
            .then(result => {
                alert('Payment saved successfully!');
                // Update local data
                updateStats(data.type, parseFloat(data.amount));
                loadTransactions();
                generateReceipt(result.transactionId);
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Failed to save payment');
            });
            */
            
            // For demo purposes only (remove in production)
            // const transactionId = 'TXN-' + Date.now().toString().slice(-6);
            // alert(`${data.type === 'income' ? 'Income' : 'Outcome'} payment of $${data.amount} recorded!`);
            
            // Update dashboard stats
            // updateStats(data.type, parseFloat(data.amount));
            
            // Reset form
            // resetForm(data.type === 'income' ? 'incomeForm' : 'outcomeForm');
            
            // Generate receipt
            generateReceipt({
                // id: 
                // date: new Date().toISOString().split('T')[0],
                type: storedata.type,
                party: storedata.party,
                category: storedata.category,
                description: storedata.description,
                amount: storedata.amount,
                paymentMethod: storedata.paymentMethod,
                classes: storedata.classes,
                name:storedata.name,
                admission_number:storedata.admission_number,
                session:storedata.session,
                term:storedata.term,
                week:storedata.week,
                receiver: storedata.receiver,
                Surbordinate_name:storedata.Surbordinate_name,
                transaction_id:storedata.transaction_id,
                date:storedata.date,
                time:storedata.time
            });

            generateReceiptOutCome({
                // id: 
                // date: new Date().toISOString().split('T')[0],
                type: storedata.type,
                party: storedata.party,
                category: storedata.category,
                description: storedata.description,
                amount: storedata.amount,
                paymentMethod: storedata.paymentMethod,
                classes: storedata.classes,
                name:storedata.name,
                admission_number:storedata.admission_number,
                session:storedata.session,
                term:storedata.term,
                week:storedata.week,
                receiver: storedata.receiver,
                Surbordinate_name:storedata.Surbordinate_name,
                transaction_id:storedata.transaction_id,
                date:storedata.date,
                time:storedata.time,
                approval:storedata.approval
            });
            
            // Reload transactions list
            loadTransactions();
        }
        
        // Update dashboard statistics
        function updateStats(type, amount) {
            const incomeStat = document.getElementById('incomeTotal');
            const outcomeStat = document.getElementById('outcomeTotal');
            const balanceStat = document.getElementById('balanceTotal');
            
            // DATABASE OPERATION: Get updated stats from server
            /*
            fetch('/api/stats')
            .then(response => response.json())
            .then(stats => {
                incomeStat.textContent = '$' + stats.totalIncome;
                outcomeStat.textContent = '$' + stats.totalOutcome;
                balanceStat.textContent = '$' + stats.currentBalance;
            });
            */
            
            // For demo purposes only (remove in production)
            const currentIncome = parseFloat(incomeStat.textContent.replace('$', '').replace(/,/g, ''));
            const currentOutcome = parseFloat(outcomeStat.textContent.replace('$', '').replace(/,/g, ''));
            const currentBalance = parseFloat(balanceStat.textContent.replace('$', '').replace(/,/g, ''));
            
            if (type === 'income') {
                const newIncome = currentIncome + amount;
                const newBalance = currentBalance + amount;
                
                incomeStat.textContent = '$' + newIncome.toLocaleString('en-US', {minimumFractionDigits: 2});
                balanceStat.textContent = '$' + newBalance.toLocaleString('en-US', {minimumFractionDigits: 2});
            } else {
                const newOutcome = currentOutcome + amount;
                const newBalance = currentBalance - amount;
                
                outcomeStat.textContent = '$' + newOutcome.toLocaleString('en-US', {minimumFractionDigits: 2});
                balanceStat.textContent = '$' + newBalance.toLocaleString('en-US', {minimumFractionDigits: 2});
            }
        }
        
        // Reset form fields
        function resetForm(formId) {
            document.getElementById(formId).reset();
        }
        
        // Load transactions from database
        function loadTransactions() {
            // DATABASE OPERATION: Get transactions from server
            /*
            fetch('/api/transactions')
            .then(response => response.json())
            .then(transactions => {
                displayTransactions(transactions);
            })
            .catch(error => {
                console.error('Error loading transactions:', error);
            });
            */
            
            // Sample data for demo
        }
        
        // Display transactions in table
         async function displayTransactions(){
            const tableBody = document.getElementById('transactionsTable');
        
        }

        document.addEventListener("DOMContentLoaded", function(){
            transcationHistory();
            transcationHistoryExpenses();
        });


        
    async function transcationHistory(){
        const tableBody = document.getElementById('transactionsTable');
            event.preventDefault();
            const offset = 0;
            const limit = 10;
            const e = {'offset':offset, 'limit':limit};
            try{
                const api = await fetch('/last-20-transcation', {
                    method:'POST',
                    headers:{'Content-type':'application/json'},
                    body:JSON.stringify(e)
                });
                if(!api.ok){
                    throw new Error(`Error discovered${api.status}`);
                }
                else{
                    const response = await api.json();
                    const conv = JSON.parse(response);
                    let output = '';
                    for(let i=0; i<conv.length; i++){
                        output+=`
                            <tr>
                                <td>${conv[i].transaction_id}</td>
                                <td>${conv[i].date}</td>
                                <td>${conv[i].time}</td>
                                <td>${conv[i].name}</td>
                                <td>${conv[i].class}</td>
                                <td><span class="type-badge ${conv[i].type === 'income' ? 'type-income' : 'type-outcome'}">${conv[i].type === 'income' ? 'Income' : 'Outcome'}</span></td>
                                <td>${conv[i].description}</td>
                                <td>${conv[i].amount}</td>
                                <td>${conv[i].category}</td>
                                <td>${conv[i].receiver}</td>
                                <td>${conv[i].sender}</td>
                                <td>${conv[i].method}</td>
                                <td>${conv[i].week}</td>
                                <td>${conv[i].term}</td>
                                <td>${conv[i].session}</td>
                                <td><button class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9rem;" onclick="viewReceipt('${conv[i].transaction_id}', '${conv[i].type}')"><i class="fas fa-eye"></i> View</button></td>
                            </tr> 
                        `
                    }
                   tableBody.innerHTML=output;
                }
            }
            catch(error){
                console.log(error.message);
            }
        }

        document.getElementById('loadmorebtn').addEventListener("click", transcationHistory);
        
        //transcation for a particular day
        async function transcation(){
            event.preventDefault();
            const tableBody = document.getElementById('transactionsTable');
            const date = document.getElementById("date").value;
            console.log(date);
             const d = {'date':date};
            if(!date|| date===null){
                alert('no date picked');
            }
           else{
                try{
                    const api = await fetch('/transcation-day',{
                        method:'POST',
                        headers:{'Content-type':'application/json'},
                        body:JSON.stringify(d)
                    });
                    if(!api.ok){
                    // throw new Error(`Error discovered${api.status}`);
                    if(api.status==404){
                        alert('no payment made');
                    }
                    else if(api.status===402){
                        document.getElementById('display-transcation-error').textContent='no paymnet that term';
                    }
                }
                else{
                    const response = await api.json();
                    const conv = JSON.parse(response);
                    let output = '';
                    for(let i=0; i<conv.length; i++){
                        output+=`
                           <tr>
                                <td>${conv[i].transaction_id}</td>
                                <td>${conv[i].date}</td>
                                <td>${conv[i].time}</td>
                                <td>${conv[i].name}</td>
                                <td>${conv[i].class}</td>
                                <td><span class="type-badge ${conv[i].type === 'income' ? 'type-income' : 'type-outcome'}">${conv[i].type === 'income' ? 'Income' : 'Outcome'}</span></td>
                                <td>${conv[i].description}</td>
                                <td>${conv[i].amount}</td>
                                <td>${conv[i].category}</td>
                                <td>${conv[i].receiver}</td>
                                <td>${conv[i].sender}</td>
                                <td>${conv[i].method}</td>
                                <td>${conv[i].week}</td>
                                <td>${conv[i].term}</td>
                                <td>${conv[i].session}</td>
                                <td><button class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9rem;" onclick="viewReceipt('${conv[i].transaction_id}', '${conv[i].type}')"><i class="fas fa-eye"></i> View</button></td>
                            </tr>
                        `
                    }
                    tableBody.innerHTML=output;
                    let total = 0;
                         for(let j=0; j<conv.length; j++){
                             total += parseFloat(conv[j].amount);
                         }
                         document.getElementById('total-money-term-session').innerHTML=`<p>Total:</p> ${parseFloat(total).toLocaleString('NGN-ng', {minimumFractionDigits:2})}k`;
                }
                }
                catch(error){
                    console.log(error.message);
                }
           }
        }
        //transcation for term and sesson and week 
    async function transca(){
            event.preventDefault();
             const tableBody = document.getElementById('transactionsTable');
            const session = document.getElementById('session-search').value;
            const term = document.getElementById('term-search').value;
            const week = document.getElementById('week-search').value;
            // console.log(session, term, week);
            if(!session || !term || !week){
                alert('session or term  or week not selected');
            }
            else{
                const all = {'session':session, 'term':term, 'week':week};
                try{
                    const api = await fetch('/particular-term-and-session', {
                        method:'POST',
                        headers:{'Content-type':'application/json'},
                        body:JSON.stringify(all)
                    });
                    if(!api.ok){
                     if(api.status===404){
                         alert('no payment made that particular term or week');
                     }
                }
                else{
                    const response = await api.json();
                    const conv = JSON.parse(response);
                    let output = '';
                    for(let i=0; i<conv.length; i++){
                        output+=`
                                <tr>
                                <td>${conv[i].transaction_id}</td>
                                <td>${conv[i].date}</td>
                                <td>${conv[i].time}</td>
                                <td>${conv[i].name}</td>
                                <td>${conv[i].class}</td>
                                <td><span class="type-badge ${conv[i].type === 'income' ? 'type-income' : 'type-outcome'}">${conv[i].type === 'income' ? 'Income' : 'Outcome'}</span></td>
                                <td>${conv[i].description}</td>
                                <td>${conv[i].amount}</td>
                                <td>${conv[i].category}</td>
                                <td>${conv[i].receiver}</td>
                                <td>${conv[i].sender}</td>
                                <td>${conv[i].method}</td>
                                <td>${conv[i].week}</td>
                                <td>${conv[i].term}</td>
                                <td>${conv[i].session}</td>
                                <td><button class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9rem;" onclick="viewReceipt('${conv[i].transaction_id}', '${conv[i].type}')"><i class="fas fa-eye"></i> View</button></td>
                            </tr>`
                    }
                    tableBody.innerHTML=output;
                     let total = 0;
                         for(let j=0; j<conv.length; j++){
                             total += parseFloat(conv[j].amount);
                         }
                         document.getElementById('total-money-term-session').innerHTML=`<p>Total</p>${parseFloat(total).toLocaleString('NGN-ng', {minimumFractionDigits:2})}k`;
                        
                }
                }
                catch(error){
                    console.log(error.message);
                }
            }
        }



    async function transcationHistoryExpenses(){
        const tableBody = document.getElementById('outgoingTransactionsTable');
            event.preventDefault();
            const offset = 0;
            const limit = 10;
            const e = {'offset':offset, 'limit':limit};
            try{
                const api = await fetch('/last-20-expenses', {
                    method:'POST',
                    headers:{'Content-type':'application/json'},
                    body:JSON.stringify(e)
                });
                if(!api.ok){
                    throw new Error(`Error discovered${api.status}`);
                }
                else{
                    const response = await api.json();
                    const conv = JSON.parse(response);
                    let output = '';
                    for(let i=0; i<conv.length; i++){
                        output+=`
                            <tr>
                                <td>${conv[i].transaction_id}</td>
                                <td>${conv[i].date}</td>
                                <td>${conv[i].time}</td>
                                <td>${conv[i].approval}</td>
                                <td>${conv[i].amount}</td>
                                <td><span class="type-badge ${conv[i].type === 'income' ? 'type-income' : 'type-outcome'}">${conv[i].type === 'income' ? 'Income' : 'Outcome'}</span></td>
                                <td>${conv[i].description}</td>
                                <td>${conv[i].category}</td>
                                <td>${conv[i].receiver}</td>
                                <td>${conv[i].party}</td>
                                <td>${conv[i].method}</td>
                                <td>${conv[i].week}</td>
                                <td>${conv[i].term}</td>
                                <td>${conv[i].session}</td>
                                <td><button class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9rem;" onclick="viewReceipt('${conv[i].transaction_id}', '${conv[i].type}')"><i class="fas fa-eye"></i> View</button></td>
                            </tr>
                        `
                    }
                   tableBody.innerHTML=output;
                }
            }
            catch(error){
                console.log(error.message);
            }
        }

        document.getElementById('loadmorebtn').addEventListener("click", transcationHistory);
        
        //transcation for a particular day
        async function transcationExpenses(){
            event.preventDefault();
            const tableBody = document.getElementById('outgoingTransactionsTable');
            const date = document.getElementById("date-expenses").value;
            // console.log(date);
             const d = {'date':date};
            if(!date|| date===null || date=='' || date==undefined){
                alert('no date picked');
            }
           else{
                try{
                    const api = await fetch('/expenses-for-a-particular-day',{
                        method:'POST',
                        headers:{'Content-type':'application/json'},
                        body:JSON.stringify(d)
                    });
                    if(!api.ok){
                    // throw new Error(`Error discovered${api.status}`);
                    if(api.status==404){
                        alert('no payment made');
                    }
                    else if(api.status===402){
                        document.getElementById('display-transcation-error').textContent='no paymnet that term';
                    }
                }
                else{
                    const response = await api.json();
                    const conv = JSON.parse(response);
                    let output = '';
                    for(let i=0; i<conv.length; i++){
                        output+=`
                           <tr>
                                <td>${conv[i].transaction_id}</td>
                                <td>${conv[i].date}</td>
                                <td>${conv[i].time}</td>
                                <td>${conv[i].approval}</td>
                                <td>${conv[i].amount}</td>
                                <td><span class="type-badge ${conv[i].type === 'income' ? 'type-income' : 'type-outcome'}">${conv[i].type === 'income' ? 'Income' : 'Outcome'}</span></td>
                                <td>${conv[i].description}</td>
                                <td>${conv[i].category}</td>
                                <td>${conv[i].receiver}</td>
                                <td>${conv[i].party}</td>
                                <td>${conv[i].method}</td>
                                <td>${conv[i].week}</td>
                                <td>${conv[i].term}</td>
                                <td>${conv[i].session}</td>
                                <td><button class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9rem;" onclick="viewReceipt('${conv[i].transaction_id}', '${conv[i].type}')"><i class="fas fa-eye"></i> View</button></td>
                            </tr>
                        `
                    }
                    tableBody.innerHTML=output;
                    let total = 0;
                         for(let j=0; j<conv.length; j++){
                             total += parseFloat(conv[j].amount);
                         }
                         document.getElementById('total-money-term-session-expenses').innerHTML=`<p>Total:</p> ${parseFloat(total).toLocaleString('NGN-ng', {minimumFractionDigits:2})}k`;
                }
                }
                catch(error){
                    console.log(error.message);
                }
           }
        }
        //transcation for term and sesson and week 
    async function transcaExpenses(){
            event.preventDefault();
            const tableBody = document.getElementById('outgoingTransactionsTable');
            const session = document.getElementById('session-search-expenses').value;
            const term = document.getElementById('term-search-expenses').value;
            const week = document.getElementById('week-search-expenses').value;
            // console.log(session, term, week);
            if(!session || !term || !week){
                alert('session or term  or week not selected');
            }
            else{
                const all = {'session':session, 'term':term, 'week':week};
                try{
                    const api = await fetch('/expenses-particular-term-and-session', {
                        method:'POST',
                        headers:{'Content-type':'application/json'},
                        body:JSON.stringify(all)
                    });
                    if(!api.ok){
                     if(api.status===404){
                         alert('no payment made that particular term or week');
                     }
                }
                else{
                    const response = await api.json();
                    const conv = JSON.parse(response);
                    let output = '';
                    for(let i=0; i<conv.length; i++){
                        output+=`
                            <tr>
                                <td>${conv[i].transaction_id}</td>
                                <td>${conv[i].date}</td>
                                <td>${conv[i].time}</td>
                                <td>${conv[i].approval}</td>
                                <td>${conv[i].amount}</td>
                                <td><span class="type-badge ${conv[i].type === 'income' ? 'type-income' : 'type-outcome'}">${conv[i].type === 'income' ? 'Income' : 'Outcome'}</span></td>
                                <td>${conv[i].description}</td>
                                <td>${conv[i].category}</td>
                                <td>${conv[i].receiver}</td>
                                <td>${conv[i].party}</td>
                                <td>${conv[i].method}</td>
                                <td>${conv[i].week}</td>
                                <td>${conv[i].term}</td>
                                <td>${conv[i].session}</td>
                                <td><button class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9rem;" onclick="viewReceipt('${conv[i].transaction_id}', '${conv[i].type}')"><i class="fas fa-eye"></i> View</button></td>
                            </tr>`
                    }
                    tableBody.innerHTML=output;
                     let total = 0;
                         for(let j=0; j<conv.length; j++){
                             total += parseFloat(conv[j].amount);
                         }
                         document.getElementById('total-money-term-session-expenses').innerHTML=`<p>Total</p>${parseFloat(total).toLocaleString('NGN-ng', {minimumFractionDigits:2})}k`;
                        
                }
                }
                catch(error){
                    console.log(error.message);
                }
            }
        }

        // Load more transactions
        function loadMoreTransactions() {
            // DATABASE OPERATION: Load more transactions with pagination
        
        }
        
        // Load receipts from database
        function loadReceipts() {
            // DATABASE OPERATION: Get receipts from server
            /*
            fetch('/api/receipts')
            .then(response => response.json())
            .then(receipts => {
                displayReceipts(receipts);
            });
            */
            
            // Sample data for demo
            // const receipts = [
            //     {id: 'REC-001', date: '2023-10-28', type: 'income', amount: '1250.00', party: 'John Doe'},
            //     {id: 'REC-002', date: '2023-10-28', type: 'outcome', amount: '2350.75', party: 'Power Utility Co.'},
            //     {id: 'REC-003', date: '2023-10-27', type: 'income', amount: '5000.00', party: 'ABC Corporation'},
            // ];
            
            // displayReceipts(receipts);
        }
        //display transaction
                //      row.innerHTML = `
                //     <td>${formattedDate}</td>
                //      <td><span class="type-badge ${trans.type === 'income' ? 'type-income' : 'type-outcome'}">${trans.type === 'income' ? 'Income' : 'Outcome'}</span></td>
                //      <td>${trans.party}</td>
                //      <td>${trans.description}</td>
                //      <td><strong style="color: ${trans.type === 'income' ? 'var(--success)' : 'var(--danger)'}">${trans.type === 'income' ? '+' : '-'}$${trans.amount}</strong></td>
                //      <td><span class="status-badge status-${trans.status}">${trans.status.charAt(0).toUpperCase() + trans.status.slice(1)}</span></td>
                //      <td><button class="btn btn-secondary" style="padding: 5px 10px; font-size: 0.9rem;" onclick="viewReceipt('${trans.date}', '${trans.type}', '${trans.party}', '${trans.amount}', '${trans.description}')"><i class="fas fa-eye"></i> View</button></td>
                //  `;
        
        // Display receipts list
        // function displayReceipts(receipts) {
        //     const receiptsList = document.getElementById('receiptsList');
        //     receiptsList.innerHTML = '';
            
        //     receipts.forEach(receipt => {
        //         const receiptDiv = document.createElement('div');
        //         receiptDiv.style.cssText = 'background-color: white; border-radius: 8px; padding: 15px; margin-bottom: 10px; border-left: 4px solid var(--' + (receipt.type === 'income' ? 'success' : 'danger') + ');';
                
        //         const dateObj = new Date(receipt.date);
        //         const formattedDate = dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                
        //         receiptDiv.innerHTML = `
        //             <div style="display: flex; justify-content: space-between; align-items: center;">
        //                 <div>
        //                     <div style="font-weight: 600; color: var(--dark);">${receipt.id} - ${receipt.party}</div>
        //                     <div style="font-size: 0.9rem; color: var(--gray);">${formattedDate}  ${receipt.type === 'income' ? 'Income' : 'Outcome'}</div>
        //                 </div>
        //                 <div style="text-align: right;">
        //                     <div style="font-weight: 700; color: ${receipt.type === 'income' ? 'var(--success)' : 'var(--danger)'};">$${receipt.amount}</div>
        //                     <button class="btn btn-primary" style="padding: 5px 10px; font-size: 0.9rem; margin-top: 5px;" onclick="viewReceipt('${receipt.date}', '${receipt.type}', '${receipt.party}', '${receipt.amount}', '${receipt.id} Payment')"><i class="fas fa-receipt"></i> View Receipt</button>
        //                 </div>
        //             </div>
        //         `;
                
        //         receiptsList.appendChild(receiptDiv);
        //     });
        // }
        
        // Generate receipt
        function generateReceipt(storedata) {
            const dateObj = new Date(storedata.date);
            const formattedDate = dateObj.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            const now = new Date();
            const formattedTime = now.toLocaleTimeString('NGN-ng', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            // Category names
            const categoryNames = {
                tuition: 'Tuition Fees',
                registration: 'Registration Fees',
                exam: 'Examination Fees',
                donation: 'Donation',
                grant: 'Grant',
                salaries: 'Salaries',
                utilities: 'Utilities',
                supplies: 'Supplies',
                maintenance: 'Maintenance',
                services: 'Services',
                other: storedata.type === 'income' ? 'Other Income' : 'Other Expense'
            };
            
            // Method names
            const methodNames = {
                cash: 'Cash',
                bank: 'Bank Transfer',
                check: 'Check',
                card: 'Credit/Debit Card'
            };
             const nameToUse = document.getElementById('profile-name').innerHTML;
            // Build receipt HTML
            const receiptHTML = `
                <div class="receipt-header">
                    <h2>OFFICIAL PAYMENT RECEIPT</h2>
                    <h4> Abundant Light Mega Academy - Finance Department</h4>
                    <p>4, OPEMIPO STREET, NEW GARAGE OKITIPUPA, ONDO STATE, NIGERIA.</p>
                    <i>MOTTO: THE LIGHT OF THE WORLD</i>
                </div>
                
                <div class="receipt-details">
                    <div>
                        <div class="receipt-item">
                            <label>Transaction ID </label>
                            <div class="value">${storedata.transaction_id}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Date & Time</label>
                            <div class="value">${storedata.date}<br>${storedata.time}</div>
                        </div>
                        <div class="receipt-item">
                            <label>${storedata.type === 'income' ? 'Received From' : 'Paid To'}</label>
                            <div class="value">${storedata.party}</div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="receipt-item">
                            <label>Transaction Type</label>
                            <div class="value">${storedata.type === 'income' ? 'INCOME' : 'OUTCOME'}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Sender</label>
                            <div class="value">${storedata.party}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Receiver</label>
                            <div class="value">${storedata.receiver}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Approval</label>
                            <div class="value">${storedata.approval}</div>
                        </div>        
                        <div class="receipt-item">
                            <label>Category</label>
                            <div class="value">${categoryNames[storedata.category] || storedata.category}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Payment Method</label>
                            <div class="value">${methodNames[storedata.paymentMethod] || storedata.paymentMethod}</div>
                        </div>
                    </div>
                </div>
                
                <div class="receipt-amount">
                    <div class="amount">${parseFloat(storedata.amount).toLocaleString('NGN-ng', {minimumFractionDigits: 2})}k</div>
                    <div class="value">${storedata.type === 'income' ? 'AMOUNT PAID':''}</div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div class="receipt-item">
                        <label>Description</label>
                        <div class="value">${storedata.description}</div>
                    </div>
                </div>
                
                <div class="receipt-footer">
                    <p>This is an official receipt for accounting purposes.</p>
                    <p style="margin-top: 20px; padding-top: 20px; border-top: 1px dashed var(--border);">
                        <strong>Authorized Signature:</strong> ___________________________
                    </p>
                    <p><em>${nameToUse}, Bursar</em></p>
                </div>
            `;
            
            // Insert receipt into modal
            document.getElementById('receiptContent').innerHTML = receiptHTML;
            
            // Show modal
            document.getElementById('receiptModal').classList.add('active');
        }


         function generateReceiptOutCome(storedata) {
            const dateObj = new Date(storedata.date);
            const formattedDate = dateObj.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            const now = new Date();
            const formattedTime = now.toLocaleTimeString('NGN-ng', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            // Category names
            const categoryNames = {
                tuition: 'Tuition Fees',
                registration: 'Registration Fees',
                exam: 'Examination Fees',
                donation: 'Donation',
                grant: 'Grant',
                salaries: 'Salaries',
                utilities: 'Utilities',
                supplies: 'Supplies',
                maintenance: 'Maintenance',
                services: 'Services',
                other: storedata.type === 'income' ? 'Other Income' : 'Other Expense'
            };
            
            // Method names
            const methodNames = {
                cash: 'Cash',
                bank: 'Bank Transfer',
                check: 'Check',
                card: 'Credit/Debit Card'
            };
             const nameToUse = document.getElementById('profile-name').innerHTML;
            // Build receipt HTML
            const receiptHTML = `
                <div class="receipt-header">
                    <h2>OFFICIAL PAYMENT RECEIPT</h2>
                    <h4> Abundant Light Mega Academy - Finance Department</h4>
                    <p>4, OPEMIPO STREET, NEW GARAGE OKITIPUPA, ONDO STATE, NIGERIA.</p>
                    <i>MOTTO: THE LIGHT OF THE WORLD</i>
                </div>
                
                <div class="receipt-details">
                    <div>
                        <div class="receipt-item">
                            <label>Transaction ID </label>
                            <div class="value">${storedata.transaction_id}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Date & Time</label>
                            <div class="value">${storedata.date}<br>${storedata.time}</div>
                        </div>
                        <div class="receipt-item">
                            <label>${storedata.type === 'income' ? 'Received From' : 'Paid To'}</label>
                            <div class="value">${storedata.receiver}</div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="receipt-item">
                            <label>Transaction Type</label>
                            <div class="value">${storedata.type === 'income' ? 'INCOME' : 'OUTCOME'}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Sender</label>
                            <div class="value">${storedata.party}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Receiver</label>
                            <div class="value">${storedata.receiver}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Approval </label>
                            <div class="value">${storedata.approval}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Surbordinate Name</label>
                            <div class="value">${storedata.Surbordinate_name}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Session</label>
                            <div class="value">${storedata.session}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Term</label>
                            <div class="value">${storedata.term}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Category</label>
                            <div class="value">${categoryNames[storedata.category] || storedata.category}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Payment Method</label>
                            <div class="value">${methodNames[storedata.method] || storedata.method}</div>
                        </div>
                    </div>
                </div>
                
                <div class="receipt-amount">
                    <div class="amount">${parseFloat(storedata.amount).toLocaleString('NGN-ng', {minimumFractionDigits: 2})}k</div>
                    <div class="value">${storedata.type === 'income' ? 'AMOUNT PAID':''}</div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div class="receipt-item">
                        <label>Description</label>
                        <div class="value">${storedata.description}</div>
                    </div>
                </div>
                
                <div class="receipt-footer">
                    <p>This is an official receipt for accounting purposes.</p>
                    <p style="margin-top: 20px; padding-top: 20px; border-top: 1px dashed var(--border);">
                        <strong>Authorized Signature:</strong> ___________________________
                    </p>
                    <p><em>${nameToUse}, Bursar</em></p>
                </div>
            `;
            
            // Insert receipt into modal
            document.getElementById('receiptContent').innerHTML = receiptHTML;
            
            // Show modal
            document.getElementById('receiptModal').classList.add('active');
        }
        
        // View existing receipt
        async function viewReceipt(transaction_id,type) {
                // console.log(transaction_id, type);
            if(type=='income'){
                const data = {transaction_id:transaction_id, type:type};
                const api = await fetch('/generate-receipt', {
                    method:'POST',
                    headers:{'Content-type':'application/json'},
                    body:JSON.stringify(data)
                });
                if(!api.ok){

                }
                else{
                    const response = await api.json();
                    const convert = JSON.parse(response);
            const categoryNames = {
                tuition: 'Tuition Fees',
                registration: 'Registration Fees',
                exam: 'Examination Fees',
                donation: 'Donation',
                grant: 'Grant',
                salaries: 'Salaries',
                utilities: 'Utilities',
                supplies: 'Supplies',
                maintenance: 'Maintenance',
                services: 'Services',
                other: convert.type === 'income' ? 'Other Income' : 'Other Expense'
            };
            
            // Method names
            const methodNames = {
                cash: 'Cash',
                bank: 'Bank Transfer',
                check: 'Check',
                card: 'Credit/Debit Card'
            };
             const nameToUse = document.getElementById('profile-name').innerHTML;
                    const receiptHTML = `
                        <div class="receipt-header">
                            <h2>OFFICIAL PAYMENT RECEIPT</h2>
                            <h4> Abundant Light Mega Academy - Finance Department</h4>
                            <p>4, OPEMIPO STREET, NEW GARAGE OKITIPUPA, ONDO STATE, NIGERIA.</p>
                            <i>MOTTO: THE LIGHT OF THE WORLD</i>
                        </div>
                        
                        <div class="receipt-details">
                            <div>
                                <div class="receipt-item">
                                    <label>Transaction ID </label>
                                    <div class="value">${convert.transaction_id}</div>
                                </div>
                                <div class="receipt-item">
                                    <label>Date & Time</label>
                                    <div class="value">${convert.date}<br>${convert.time}</div>
                                </div>
                                <div class="receipt-item">
                                    <label>${convert.receiver === 'income' ? 'Received From' : 'Paid To'}</label>
                                    <div class="value">${convert.receiver}</div>
                                </div>
                            </div>
                            
                            <div>
                                <div class="receipt-item">
                                    <label>Transaction Type</label>
                                    <div class="value">${convert.type === 'income' ? 'INCOME' : 'OUTCOME'}</div>
                                </div>
                                <div class="receipt-item">
                                    <label>Sender</label>
                                    <div class="value">${convert.sender}</div>
                                </div>
                                <div class="receipt-item">
                                    <label>Class</label>
                                    <div class="value">${convert.class}</div>
                                </div> 
                                <div class="receipt-item">
                                    <label>Admission number</label>
                                    <div class="value">${convert.admission_number}</div>
                                </div> 
                                <div class="receipt-item">
                                    <label>Method</label>
                                    <div class="value">${convert.method}</div>
                                </div> 
                                <div class="receipt-item">
                                    <label>Category</label>
                                    <div class="value">${convert.category}</div>
                                </div> 
                                <div class="receipt-item">
                                    <label>Subordinate</label>
                                    <div class="value">${convert.surbordinate}</div>
                                </div> 
                                <div class="receipt-item">
                                    <label>Receiver</label>
                                    <div class="value">${convert.receiver}</div>
                                </div>
                                <div class="receipt-item">
                                    <label>Week</label>
                                    <div class="value">${convert.week}</div>
                                </div> 
                                <div class="receipt-item">
                                    <label>Term</label>
                                    <div class="value">${convert.term}</div>
                                </div> 
                                <div class="receipt-item">
                                    <label>Session</label>
                                    <div class="value">${convert.session}</div>
                                </div>        
                                <div class="receipt-item">
                                    <label>Category</label>
                                    <div class="value">${categoryNames[convert.category] || convert.category}</div>
                                </div>
                                <div class="receipt-item">
                                    <label>Payment Method</label>
                                    <div class="value">${methodNames[convert.paymentMethod] || convert.paymentMethod}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="receipt-amount">
                            <div class="amount">${parseFloat(convert.amount).toLocaleString('NGN-ng', {minimumFractionDigits: 2})}k</div>
                            <div class="value">${convert.type === 'income' ? 'AMOUNT PAID':''}</div>
                        </div>
                        
                        <div style="margin-bottom: 25px;">
                            <div class="receipt-item">
                                <label>Description</label>
                                <div class="value">${convert.description}</div>
                            </div>
                        </div>
                        
                        <div class="receipt-footer">
                            <p>This is an official receipt for accounting purposes.</p>
                            <p style="margin-top: 20px; padding-top: 20px; border-top: 1px dashed var(--border);">
                                <strong>Authorized Signature:</strong> ___________________________
                            </p>
                            <p><em>${nameToUse}, Bursar</em></p>
                        </div>
                    `;
                    document.getElementById('receiptContent').innerHTML = receiptHTML;
                    document.getElementById('receiptModal').classList.add('active');
                }
            }
            else{
                 const data = {transaction_id:transaction_id, type:type};
                 
                const api = await fetch('/generate-receipt-outcome', {
                    method:'POST',
                    headers:{'Content-type':'application/json'},
                    body:JSON.stringify(data)
                });
                if(!api.ok){

                }
                else{
                    const response = await api.json();
                    const convert = JSON.parse(response);
            const categoryNames = {
                tuition: 'Tuition Fees',
                registration: 'Registration Fees',
                exam: 'Examination Fees',
                donation: 'Donation',
                grant: 'Grant',
                salaries: 'Salaries',
                utilities: 'Utilities',
                supplies: 'Supplies',
                maintenance: 'Maintenance',
                services: 'Services',
                other: convert.type === 'income' ? 'Other Income' : 'Other Expense'
            };
            
            // Method names
            const methodNames = {
                cash: 'Cash',
                bank: 'Bank Transfer',
                check: 'Check',
                card: 'Credit/Debit Card'
            };
             const nameToUse = document.getElementById('profile-name').innerHTML;
                    const receiptHTML = `
                         <div class="receipt-header">
                    <h2>OFFICIAL PAYMENT RECEIPT</h2>
                    <h4> Abundant Light Mega Academy - Finance Department</h4>
                    <p>4, OPEMIPO STREET, NEW GARAGE OKITIPUPA, ONDO STATE, NIGERIA.</p>
                    <i>MOTTO: THE LIGHT OF THE WORLD</i>
                </div>
                
                <div class="receipt-details">
                    <div>
                        <div class="receipt-item">
                            <label>Transaction ID </label>
                            <div class="value">${convert.transaction_id}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Date & Time</label>
                            <div class="value">${convert.date}<br>${convert.time}</div>
                        </div>
                        <div class="receipt-item">
                            <label>${convert.type === 'income' ? 'Received From' : 'Paid To'}</label>
                            <div class="value">${convert.receiver}</div>
                        </div>
                    </div>
                    
                    <div>
                        <div class="receipt-item">
                            <label>Transaction Type</label>
                            <div class="value">${convert.type === 'income' ? 'INCOME' : 'OUTCOME'}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Sender</label>
                            <div class="value">${convert.party}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Receiver</label>
                            <div class="value">${convert.receiver}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Approval </label>
                            <div class="value">${convert.approval}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Surbordinate Name</label>
                            <div class="value">${convert.Surbordinate_name}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Session</label>
                            <div class="value">${convert.session}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Term</label>
                            <div class="value">${convert.term}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Category</label>
                            <div class="value">${categoryNames[convert.category] || convert.category}</div>
                        </div>
                        <div class="receipt-item">
                            <label>Payment Method</label>
                            <div class="value">${methodNames[convert.method] || convert.method}</div>
                        </div>
                    </div>
                </div>
                
                <div class="receipt-amount">
                    <div class="amount">${parseFloat(convert.amount).toLocaleString('NGN-ng', {minimumFractionDigits: 2})}k</div>
                    <div class="value">${convert.type === 'income' ? 'AMOUNT PAID':''}</div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div class="receipt-item">
                        <label>Description</label>
                        <div class="value">${convert.description}</div>
                    </div>
                </div>
                
                <div class="receipt-footer">
                    <p>This is an official receipt for accounting purposes.</p>
                    <p style="margin-top: 20px; padding-top: 20px; border-top: 1px dashed var(--border);">
                        <strong>Authorized Signature:</strong> ___________________________
                    </p>
                    <p><em>${nameToUse}, Bursar</em></p>
                </div>
                    `;
                    document.getElementById('receiptContent').innerHTML = receiptHTML;
                    document.getElementById('receiptModal').classList.add('active');
                }
            }
        }
        
        // Generate a real receipt form database record (for demo)

        // function generateSampleReceipt() {
        //     generateReceiptOutCome({
        //         id: 'REC-SAMPLE-001',
        //         date: new Date().toISOString().split('T')[0],
        //         type: 'income',
        //         party: 'Sample Payer',
        //         category: 'tuition',
        //         description: 'Sample payment for demonstration purposes',
        //         amount: '1000.00',
        //         paymentMethod: 'cash'
        //     });
        // }
        
        // Close modals
        function closeModal() {
            document.getElementById('receiptModal').classList.remove('active');
        }
        
        function closeConfirmModal() {
            document.getElementById('confirmModal').classList.remove('active');
        }
        
        // Print receipt
        function printReceipt() {
            window.print();
        }
        
        // Logout
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                alert('Logged out successfully. In a real application, this would redirect to login page.');
                 window.location.href = '/';
                 localStorage.clear();
            }
        }
    </script>
     <script>
            document.addEventListener("DOMContentLoaded", ()=>{
                getinfo();
            });
            async function getinfo(){
                const getEmail = localStorage.getItem('Alma');
                const e = {'email':getEmail};
                if(!getEmail){
                    // window.location.href='/';
                }
                else{
                    const api = await fetch('/bursar-info', {
                        method:'POST',
                        headers:{'Content-type':'application/json'},
                        body:JSON.stringify(e)
                    })
                    
                    if(!api.ok){

                    }
                    else{
                        const result = await api.json(api);
                        const conv = JSON.parse(result);
                        document.getElementById("profile-name").textContent=conv.name;
                        // document.getElementById('profile-picute').innerHTML=`<img src="${'/uploads/'+conv.profile}" alt="Profile Image" style="width: 100%; height: 100%; border-radius: 50%;">`;
                    }
                }
            }
//             // In your server-side code (Node.js/Express example)
// const multer = require('multer');
// const upload = multer({ dest: 'uploads/' });

// app.post('/OutCome-payment', upload.single('receipt'), async (req, res) => {
//     try {
//         // Access form fields from req.body
//         const {
//             type, amount, party, category, description,
//             method, session, term, week, receiver,
//             date, time, transaction_id, approval
//         } = req.body;
        
//         // Access uploaded file info
//         const receipt = req.file ? req.file.filename : null;
        
//         // Your database logic here...
        
//         res.status(200).json({ 
//             success: true, 
//             message: 'Outcome payment saved successfully' 
//         });
//     } catch (error) {
//         console.error(error);
//         res.status(500).json({ success: false, message: error.message });
//     }
// });


// Example backend code (Node.js/Express)
const multer = require('multer');
const path = require('path');

// Configure multer for file upload
// const storage = multer.diskStorage({
//     destination: function (req, file, cb) {
//         cb(null, 'uploads/receipts/');
//     },
//     filename: function (req, file, cb) {
//         const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);
//         cb(null, file.fieldname + '-' + uniqueSuffix + path.extname(file.originalname));
//     }
// });

// const upload = multer({ 
//     storage: storage,
//     limits: {
//         fileSize: 5 * 1024 * 1024 // 5MB limit
//     },
//     fileFilter: function (req, file, cb) {
//         // Accept images and PDFs
//         const filetypes = /jpeg|jpg|png|gif|pdf/;
//         const mimetype = filetypes.test(file.mimetype);
//         const extname = filetypes.test(path.extname(file.originalname).toLowerCase());
        
//         if (mimetype && extname) {
//             return cb(null, true);
//         }
//         cb(new Error('Only image files (JPEG, PNG, GIF) and PDFs are allowed'));
//     }
// });

// // Route handler
// app.post('/OutCome-payment', upload.single('receipt'), async (req, res) => {
//     try {
//         console.log('Received outcome payment request');
//         console.log('Body:', req.body);
//         console.log('File:', req.file);
        
//         const {
//             type, amount, party, approval,
//             receiver, category, description,
//             method, session, term, week,
//             date, time, transaction_id
//         } = req.body;
        
//         // Validate required fields
//         if (!amount || !party || !approval || !receiver || !category || !session || !term || !week || !method) {
//             return res.status(400).json({ 
//                 success: false, 
//                 message: 'Missing required fields' 
//             });
//         }
        
//         // Get file info if uploaded
//         const receiptFile = req.file ? {
//             filename: req.file.filename,
//             originalname: req.file.originalname,
//             path: req.file.path,
//             size: req.file.size
//         } : null;
        
//         // Save to database (your database logic here)
//         // const result = await saveOutcomeToDatabase(...);
        
//         res.status(200).json({
//             success: true,
//             message: 'Outcome payment saved successfully',
//             transaction_id: transaction_id,
//             receipt: receiptFile ? receiptFile.filename : null
//         });
        
//     } catch (error) {
//         console.error('Error processing outcome payment:', error);
//         res.status(500).json({
//             success: false,
//             message: 'Server error: ' + error.message
//         });
//     }
// });
        </script>
</body>
</html>